# Check if source has data
if spark.table("SQ_Src_DUMMY").limit(1).count() > 0:
    raise RuntimeError("MAPPING ABORTED")

# If no rows, continue normally
exp_Dummy_Abort_Mapping = spark.sql("""
SELECT
    DUMMY,
    source_record_id
FROM SQ_Src_DUMMY
""")

exp_Dummy_Abort_Mapping.createOrReplaceTempView("exp_Dummy_Abort_Mapping")
